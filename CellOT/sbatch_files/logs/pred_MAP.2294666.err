/home/groups/gbrice/ptb-drugscreen/ot/cellot/cells_combined/peter_ot/lib/python3.9/site-packages/anndata/_core/anndata.py:1754: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
/home/groups/gbrice/ptb-drugscreen/ot/cellot/cells_combined/peter_ot/lib/python3.9/site-packages/anndata/_core/anndata.py:1754: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
/home/groups/gbrice/ptb-drugscreen/ot/cellot/cells_combined/peter_ot/lib/python3.9/site-packages/anndata/_core/anndata.py:1754: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
Traceback (most recent call last):
  File "/home/groups/gbrice/ptb-drugscreen/ot/cellot/make_prediction/predict_unstim_drug_ina.py", line 139, in <module>
    row = predict_per_patient(result_path, unstim_data_path, stim, model, cell_type, patient,drug_used)
  File "/home/groups/gbrice/ptb-drugscreen/ot/cellot/make_prediction/predict_unstim_drug_ina.py", line 62, in predict_per_patient
    loader = DataLoader(dataset, batch_size=len(dataset), shuffle=False)
  File "/home/groups/gbrice/ptb-drugscreen/ot/cellot/cells_combined/peter_ot/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 283, in __init__
    batch_sampler = BatchSampler(sampler, batch_size, drop_last)
  File "/home/groups/gbrice/ptb-drugscreen/ot/cellot/cells_combined/peter_ot/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 215, in __init__
    raise ValueError("batch_size should be a positive integer value, "
ValueError: batch_size should be a positive integer value, but got batch_size=0
